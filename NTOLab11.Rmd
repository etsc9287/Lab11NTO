---
title: "NTOLab11"
author: "Not Team One"
date: "4/2/2019"
output: html_document
---

```{r,echo=FALSE, include=FALSE}

library(tidyverse)
library(babynames)
library(stringr)
data1 <- babynames::babynames
```

**** 
#### Ethan's Section
****
```{r,echo=FALSE}

data2 <- data1 %>%
  filter(str_detect(data1$name, "^Eth")) %>%
  group_by(year) %>%
  summarise(proportion = sum(prop))

data3 <- data1 %>%
  filter(str_detect(data1$name, "^Ethan$")) %>%
  group_by(year) %>%
  summarise(proportion = sum(prop))

ggplot() +
  geom_line(data = data2, mapping = aes(x = year, y = proportion), color = "blue") +
  geom_line(data = data3, mapping = aes(x = year, y = proportion), color = "red") +
  xlab("Year") +
  ylab("Name Proportion") +
  ggtitle("Time Series of Ethan and Names Beginning With Eth", subtitle = "Blue = Names Starting With Eth; Red = Ethan")

Ethan_versions <- data1 %>%
  filter(str_detect(data1$name, "^Eth.n$")) %>% #Ethan, Ethyn, Ethin, Ethon, etc.
  group_by(year) %>%
  summarise(proportion = sum(prop))

#absolute change in proportions
prop_change_1999 = 0.00637829 - 0.00569811 #Eth...n prop 2017 - Eth...n prop 1999 = 0.00068
prop_change_1980 = 0.00569811 - 0.00038059 #Eth...n prop 1999 - Eth...n prop 1980 = 0.00532

```

* My name was becoming incredibly popular when I was born in 1999, and it still makes up nearly
all of the names starting with "Eth".  However, the name has been declining since 2002 when it 
hit its peak at a proportion of 0.0107.  In 2017, the proportion of "Eth" names was 0.0064 and 
the proportion of "Ethan" was 0.0063.  This means that 98.4% of all names starting with "Eth" 
are "Ethan".  My name appeared to begin rapidly gain popularity around the 1990's.

**** 
#### Arie's Section
****
```{r,echo=FALSE}

```

**** 
#### David's Section
****
```{r,echo=FALSE}

dav <- data1 %>% filter(str_detect(name, "^Dav")) %>% group_by(year) %>% summarise(count = sum(n))
david <- data1 %>% filter(str_detect(name,"^[D]avi[d]$")) %>% group_by(year) %>% summarise(count = sum(n)) 

ggplot()+
  geom_line(data = david, mapping = aes(x = year, y = count), color = "blue")+
    geom_line(data = dav, mapping = aes(x = year, y = count), color = "red") + ggtitle("Time Series of 'Dav' and 'David' names") 

## daov <- data1 %>% filter(str_detect(name, "^Dav")) %>% group_by(name) %>% count()

```

* The time series of all the names that begin with 'Dav' hug the time series of 'David' name very closely. This means that the popularity of names that begin with 'Dav' is due to the popularity of the name 'David'. As more people were named 'David' variations of 'David' were created but never became a unique and prominent name.
* The popularity of 'David' was the highest around the 1960s. I was born in 1999 during a decline in 'David' popularity. Personally this makes sense, I have not met many people my age named 'David' but I have met plenty of middle aged people names 'David'.

**** 
#### Anderson's Section
****
```{r,echo=FALSE}

```

**** 
#### Ryan's Section
****
```{r,echo=FALSE}

```

**** 
#### Ariel / Rachel Regex
****
```{r,echo=FALSE}

arielRachel <- data1 %>%
  filter(year == 1973 | year == 1988 | year == 1990 | year == 2017) %>%
  filter(sex == "F") %>%
  filter(str_detect(name, "^Ari.l") | str_detect(name, "^Rach.l")) %>%
  arrange(year, name)
as_tibble(arielRachel)

arielRachel2 <- arielRachel %>%
  group_by(year) %>%
  summarise(prop = sum(prop))
as_tibble(arielRachel2)

```

* The first tibble displays various versions of the female names similar to "Ariel" and "Rachel" in 1973, 1988, 1990, 2017, arranged accordingly.  There were 7 versions of "Ariel" and 9 versions of "Rachel" in 1988, for example.
* The second tibble displays the probabilities of versions of the names "Ariel" or "Rachel" occuring out of all names in the given years. The year where Ariel or Rachel (or any versions) appear the most popular is 1990 at 0.01.

**** 
#### The Little Mermaid Effect
****
```{r,echo=FALSE}

ariel_change <- data1 %>%
  filter(str_detect(data1$name, "^Ari.l")) %>%
  filter(year == 1988 | year == 1989 | year == 1990) %>%
  filter(sex == "F") %>% #Shows change in proportion of "Ariel" and similar from 1988-1990
  group_by(year) %>%
  summarise(prop = sum(prop)) 

first_vowel_change <- data1 %>%
  filter(str_detect(data1$name, "^[AEIOU]")) %>%
  filter(year == 1988 | year == 1989 | year == 1990) %>%
  filter(sex == "F") %>% #Shows change in proportion of names starting with a vowel from 1988-1990
  group_by(year) %>%
  summarise(prop = sum(prop))

ggplot() +
  geom_line(data = ariel_change, mapping = aes(x = year, y = prop)) +
  xlab("Year") +
  ylab("Name Proportion") + #Ariel Graph
  ggtitle("Time Series of Ariel Name Proportion (1988-1990)")

ggplot() +
  geom_line(data = first_vowel_change, mapping = aes(x = year, y = prop)) +
  xlab("Year") +
  ylab("Name Proportion") + #Starting With Vowel Graph
  ggtitle("Time Series of Name proportion Starting With a Vowel (1988-1990)")

ariel_1988 <- data1%>%
  filter(year == 1988) %>%
  filter(sex == "F")%>%
  filter(str_detect(name, "^[AEIOU]"))

ariel_1990 <- data1%>%
  filter(year == 1990) %>%
  filter(sex == "F")%>%
  filter(str_detect(name, "^[AEIOU]"))

poop <- inner_join(ariel_1988, ariel_1990, by = "name") %>%
  mutate(difference = `prop.y` - `prop.x`) 

poop2 <- poop %>%
  select(name, difference) %>%
  arrange(desc(difference))

percentile <- 1538/1540
percentile

```

* Findings: The appears to be little significance between the two graphs, Ariel name proportion change and vowel starting name proportion change show similar movement in 1988-1990. 
